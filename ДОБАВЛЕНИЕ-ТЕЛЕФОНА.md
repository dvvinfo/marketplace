# ✅ Добавление поля "Телефон" в профиль

## Изменения

Добавлено поле "Телефон" в профиль пользователя (необязательное).

## Обновленные файлы

### Бэкенд (5 файлов)

1. **User Service - Entity**
   - `backend/apps/user-service/src/user/user.entity.ts`
   - Добавлено поле: `phone: string | null`

2. **User Service - Create DTO**
   - `backend/apps/user-service/src/user/dto/create-user.dto.ts`
   - Добавлено: `phone?: string` (необязательно)

3. **User Service - Update DTO**
   - `backend/apps/user-service/src/user/dto/update-user.dto.ts`
   - Добавлено: `phone?: string` (необязательно)

4. **API Gateway - Entity**
   - `backend/apps/api-gateway/src/modules/user/user.entity.ts`
   - Добавлено поле: `phone: string | null`

5. **API Gateway - DTOs**
   - `backend/apps/api-gateway/src/modules/user/dto/createUser.dto.ts`
   - `backend/apps/api-gateway/src/modules/user/dto/updateUser.dto.ts`
   - Добавлено: `phone?: string` (необязательно)

### Фронтенд (1 файл)

1. **ProfileForm Component**
   - `frontend/app/components/ProfileForm.vue`
   - Добавлено поле телефона в форму
   - Добавлена валидация
   - Добавлена отправка на бэкенд

## Структура поля

### Бэкенд (TypeORM)

```typescript
@Column({ name: 'phone', type: 'varchar', nullable: true })
phone: string | null;
```

### DTO (Валидация)

```typescript
@IsString()
@IsOptional()
phone?: string;
```

### Фронтенд (Vue)

```vue
<UFormField label="Телефон (необязательно)" name="phone">
  <UInput
    v-model="state.phone"
    type="tel"
    placeholder="+7 (999) 123-45-67"
    size="xl"
    color="secondary"
    variant="outline"
    class="w-full"
  />
</UFormField>
```

## Поля профиля (финальная версия)

1. **Имя** (обязательно)
2. **Фамилия** (обязательно)
3. **Email** (только чтение)
4. **Телефон** (необязательно) ✅ НОВОЕ
5. **Дата рождения** (необязательно)
6. **Пол** (необязательно)

## API

### Создание пользователя

**POST** `/auth/register`

```json
{
  "email": "user@example.com",
  "password": "password123",
  "nameFirst": "Иван",
  "nameLast": "Иванов",
  "phone": "+7 999 123-45-67",
  "birthDate": "1990-01-15T00:00:00.000Z",
  "gender": "male"
}
```

### Обновление профиля

**PUT** `/users/:id`

```json
{
  "nameFirst": "Иван",
  "nameLast": "Иванов",
  "phone": "+7 999 123-45-67",
  "birthDate": "1990-01-15T00:00:00.000Z",
  "gender": "male"
}
```

## Миграция базы данных

После обновления entity необходимо:

1. **Если используется `synchronize: true`:**
   - Поле добавится автоматически при перезапуске сервиса

2. **Если используются миграции:**
   ```sql
   ALTER TABLE users ADD COLUMN phone VARCHAR NULL;
   ```

## Тестирование

### Сценарии

✅ **Добавление телефона**
- Открыть профиль
- Ввести телефон: +7 999 123-45-67
- Сохранить
- Обновить страницу
- Проверить, что телефон сохранился

✅ **Обновление телефона**
- Изменить телефон на другой
- Сохранить
- Проверить обновление

✅ **Удаление телефона**
- Очистить поле телефона
- Сохранить
- Проверить, что телефон удален

✅ **Необязательное поле**
- Оставить телефон пустым
- Сохранить другие поля
- Убедиться, что сохранение прошло успешно

## Использование в других местах

Поле телефона можно использовать:

1. **Оформление заказа** (`/checkout`)
   - Автозаполнение из профиля
   - Сохранение в заказе

2. **Адреса доставки** (`AddressManager`)
   - Связь с адресом
   - Контактный телефон

3. **Уведомления**
   - SMS уведомления о заказах
   - Звонки курьера

## Статус

✅ **Готово и протестировано**

**Дата добавления:** 31 октября 2025
