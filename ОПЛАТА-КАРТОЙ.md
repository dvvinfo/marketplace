# Имитация оплаты картой

## Что реализовано

Добавлена имитация оплаты банковской картой для тестового проекта.

### Компонент `PaymentModal.vue`

Модальное окно с формой оплаты картой:

- **Номер карты** - форматируется автоматически (1234 5678 9012 3456)
- **Срок действия** - формат MM/YY
- **CVV** - 3 цифры
- **Имя на карте** - текстовое поле
- **Сумма к оплате** - отображается автоматически

### Логика работы

1. Пользователь заполняет форму заказа
2. Выбирает способ оплаты "Банковская карта"
3. Нажимает "Оформить заказ"
4. Открывается модальное окно оплаты
5. Вводит данные карты (любые для теста)
6. Нажимает "Оплатить"
7. Имитация обработки платежа (2 секунды)
8. 90% вероятность успеха, 10% - ошибка
9. При успехе - создается заказ и переход на страницу успеха
10. При ошибке - показывается сообщение об ошибке

### Тестовый режим

В модальном окне отображается синий блок с информацией:

> **Тестовый режим:** Используйте любые данные для имитации оплаты

Можно вводить любые данные:
- Номер карты: любые цифры (минимум 13)
- Срок: любая дата в формате MM/YY
- CVV: любые 3 цифры
- Имя: любое имя

### Валидация

Кнопка "Оплатить" активна только если:
- Номер карты содержит минимум 13 цифр
- Срок действия заполнен (5 символов MM/YY)
- CVV заполнен (3 цифры)
- Имя на карте не пустое

### Для других способов оплаты

- **Наличными при получении** - заказ создается сразу
- **Электронный кошелек** - заказ создается сразу

## Файлы

### Созданные:
- `frontend/app/components/PaymentModal.vue` - Модальное окно оплаты

### Обновленные:
- `frontend/app/pages/checkout.vue` - Добавлена логика открытия модального окна

## Использование

1. Перейдите на страницу оформления заказа
2. Заполните форму доставки
3. Выберите "Банковская карта" как способ оплаты
4. Нажмите "Оформить заказ"
5. В модальном окне введите любые данные карты
6. Нажмите "Оплатить"
7. Дождитесь обработки (2 секунды)
8. Заказ будет создан при успешной оплате

## Для продакшена

В реальном проекте нужно:

1. **Интегрировать платежный шлюз:**
   - Stripe (международные платежи)
   - ЮKassa (Россия)
   - CloudPayments (Россия)
   - Тинькофф Эквайринг (Россия)

2. **Добавить безопасность:**
   - PCI DSS сертификация
   - Токенизация данных карт
   - 3D Secure аутентификация
   - Шифрование данных

3. **Обработка платежей:**
   - Webhook для уведомлений о статусе
   - Обработка возвратов
   - Обработка ошибок
   - Логирование транзакций

4. **Сохранение карт:**
   - Токенизация для повторных платежей
   - Управление сохраненными картами
   - Автоплатежи

## Пример интеграции Stripe

```typescript
// Установка
npm install @stripe/stripe-js

// Использование
import { loadStripe } from '@stripe/stripe-js';

const stripe = await loadStripe('pk_test_...');
const { error } = await stripe.confirmCardPayment(clientSecret, {
  payment_method: {
    card: cardElement,
    billing_details: { name: 'Customer Name' }
  }
});
```

## Пример интеграции ЮKassa

```typescript
// Создание платежа
const payment = await fetch('https://api.yookassa.ru/v3/payments', {
  method: 'POST',
  headers: {
    'Authorization': 'Basic ' + btoa('shopId:secretKey'),
    'Idempotence-Key': uuid(),
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    amount: { value: '100.00', currency: 'RUB' },
    confirmation: { type: 'redirect', return_url: 'https://...' },
    description: 'Заказ №1'
  })
});
```

---

**Дата:** 31 октября 2025  
**Статус:** ✅ Тестовая имитация готова  
**Для продакшена:** Требуется интеграция реального платежного шлюза
