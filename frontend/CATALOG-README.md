# Каталог товаров - Документация

## Обзор

Реализован полнофункциональный каталог товаров с фильтрацией, поиском, сортировкой и пагинацией.

## Созданные файлы

### Страницы

- **`app/pages/products/index.vue`** - Основная страница каталога
  - Отображение товаров в виде сетки
  - Интеграция с фильтрами и сортировкой
  - Пагинация
  - Добавление товаров в корзину
  - Поиск с debounce (500ms)

### Компоненты

- **`app/components/ProductFilters.vue`** - Боковая панель фильтров

  - Фильтр по категориям (radio buttons)
  - Фильтр по цене (min/max)
  - Кнопки "Применить" и "Сбросить"
  - Sticky позиционирование

- **`app/components/ProductSort.vue`** - Выпадающий список сортировки

  - По умолчанию
  - По цене (возрастание/убывание)
  - По названию (А-Я/Я-А)
  - Новинки
  - Популярные

- **`app/components/CategoryTree.vue`** - Дерево категорий (опционально)
  - Иерархическое отображение категорий
  - Раскрытие/скрытие подкатегорий
  - Подсветка выбранной категории
  - Отображение количества товаров

### Composables

- **`app/composables/useProducts.ts`** - Переиспользуемая логика для работы с товарами
  - `fetchProducts()` - Получение товаров с фильтрами
  - `fetchProductById()` - Получение товара по ID
  - `fetchCategories()` - Получение списка категорий
  - `fetchCategoryTree()` - Получение дерева категорий
  - `fetchCategoryProducts()` - Получение товаров категории

## Функциональность

### Поиск

- Поиск по названию товара
- Debounce 500ms для оптимизации запросов
- Автоматический сброс на первую страницу при поиске

### Фильтрация

- **По категориям**: выбор одной категории или "Все категории"
- **По цене**: диапазон от минимальной до максимальной цены
- Кнопка "Применить" для применения фильтров
- Кнопка "Сбросить" для очистки всех фильтров

### Сортировка

- По умолчанию
- По цене (возрастание/убывание)
- По названию (А-Я/Я-А)
- Новинки
- Популярные

### Пагинация

- 12 товаров на страницу
- Навигация по страницам
- Кнопки "Первая" и "Последняя" страница
- Автоматическая прокрутка вверх при смене страницы

### Корзина

- Добавление товаров в корзину прямо из каталога
- Индикация товаров уже в корзине
- Защита от двойного клика

## Стили

Все компоненты используют единый стиль дизайна:

- Градиентные фоны (blue → purple → pink)
- Rounded corners (rounded-2xl, rounded-3xl)
- Тени (shadow-lg, shadow-xl, shadow-2xl)
- Hover эффекты
- Темная тема
- Адаптивный дизайн (mobile-first)

## API интеграция

### Используемые эндпоинты

```typescript
// Товары
GET /products                           // Все товары
GET /products/search                    // Поиск и фильтрация товаров
GET /products/:id                       // Товар по ID

// Категории
GET /categories                         // Все категории
GET /categories/tree                    // Дерево категорий

// Корзина
POST /cart/items                        // Добавить в корзину
GET /cart                               // Получить корзину
```

### Параметры запросов (GET /products/search)

```typescript
{
  search?: string;        // Поисковый запрос (по названию и описанию)
  categoryId?: number;    // ID категории
  minPrice?: number;      // Минимальная цена
  maxPrice?: number;      // Максимальная цена
  inStock?: boolean;      // Только товары в наличии
  onSale?: boolean;       // Только товары со скидкой
  sortBy?: string;        // Поле сортировки: 'price' | 'title' | 'createdAt' | 'rating'
  sortOrder?: string;     // Порядок: 'ASC' | 'DESC'
  page?: number;          // Номер страницы (начиная с 1)
  limit?: number;         // Количество на странице
}
```

### Ответ API

```typescript
{
  products: Product[];    // Массив товаров
  total: number;          // Общее количество товаров
  page: number;           // Текущая страница
  limit: number;          // Товаров на странице
  totalPages: number;     // Всего страниц
}
```

## Использование

### Базовое использование

```vue
<template>
  <NuxtLink to="/products"> Перейти в каталог </NuxtLink>
</template>
```

### Использование composable

```vue
<script setup>
const { fetchProducts, fetchCategories } = useProducts();

const result = ref(null);
const categories = ref([]);

onMounted(async () => {
  categories.value = await fetchCategories();

  result.value = await fetchProducts({
    search: "iPhone",
    categoryId: 1,
    minPrice: 100,
    maxPrice: 1000,
    sortBy: "price",
    sortOrder: "ASC",
    page: 1,
    limit: 12,
  });

  console.log("Products:", result.value.products);
  console.log("Total:", result.value.total);
  console.log("Pages:", result.value.totalPages);
});
</script>
```

## Навигация

Добавлена ссылка "Каталог" в главное меню (AppHeader):

- Главная → `/`
- Каталог → `/products`
- Корзина → `/cart`

## Что дальше?

Следующие этапы разработки:

1. ✅ Этап 2: Каталог с фильтрами (87.5% готово)
2. ⏳ Этап 3: Оформление заказа
3. ⏳ Этап 4: Промокоды в корзине
4. ⏳ Этап 5: История заказов
5. ⏳ Этап 6: Профиль пользователя

### Опциональные улучшения для каталога:

- [ ] Breadcrumbs навигация
- [ ] Сохранение фильтров в URL (query params)
- [ ] Skeleton loaders для загрузки
- [ ] Бесконечная прокрутка вместо пагинации
- [ ] Сравнение товаров
- [ ] Избранное (wishlist)
- [ ] Недавно просмотренные товары

## Примечания

- Все компоненты полностью типизированы (TypeScript)
- Используется Nuxt UI для единообразия
- Адаптивный дизайн (mobile-first)
- Поддержка темной темы
- Оптимизация запросов (debounce для поиска)
- Обработка ошибок с toast уведомлениями
